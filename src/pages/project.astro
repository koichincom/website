---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import ProjectList from "../components/ProjectList.astro";

const title = "Projects - Koichi Nakayamada";
const h1 = "Projects";

const projectEntries = await getCollection("projects");
const sortProjects = (
    entries: typeof projectEntries,
): typeof projectEntries =>
    entries.sort((a, b) => {
        const pinnedDelta = Number(b.data.pinned ?? false) -
            Number(a.data.pinned ?? false);
        if (pinnedDelta !== 0) {
            return pinnedDelta;
        }
        return (
            new Date(b.data.published).getTime() -
            new Date(a.data.published).getTime()
        );
    });

const standardProjects = sortProjects(
    projectEntries.filter((project) => !project.data.research),
);
const researchProjects = sortProjects(
    projectEntries.filter((project) => project.data.research),
);
---

<BaseLayout title={title} h1={h1}>
    <section class="mb-20">
        <ProjectList projects={standardProjects} />
    </section>
    {
        researchProjects.length ? (
            <section class="mb-20">
                <!-- <h2 class="text-lg font-semibold text-(--color-text-first) dark:text-(--color-text-first-dark)"> -->
                <!--     Research -->
                <!-- </h2> -->
                <!-- <p class="mt-2 text-base text-(--color-text-third) dark:text-(--color-text-third-dark)"> -->
                <!--     Requires dedicated hardware, hosting, or notebook-based -->
                <!--     workflows. -->
                <!-- </p> -->
                <div class="mt-6">
                    <ProjectList projects={researchProjects} />
                </div>
            </section>
        ) : null
    }
</BaseLayout>
