---
import { ViewTransitions } from "astro:transitions";
import { Font } from "astro:assets";
import Header from "../components/header.astro";
import Footer from "../components/footer.astro";
import Shortcuts from "../components/shortcuts.astro";
import "../styles/global.css";
export interface Props {
    title?: string;
    h1?: string;
    description?: string;
}
const { title = "Koichi's Website" } = Astro.props;
const { h1 } = Astro.props;
const { description = "Koichi Nakayamada's personal website and writing" } =
    Astro.props;
const siteUrl = "https://koichin.com" + Astro.url.pathname;
---

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <meta name="description" content={description} />
        <title>{title}</title>

        <Font cssVariable="--font-family-inter" preload />
        <Font cssVariable="--font-family-lora" />
        <Font cssVariable="--font-family-iosevka" />

        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:url" content={siteUrl} />
        <meta property="og:type" content="website" />

        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={title} />
        <meta name="twitter:description" content={description} />
        <meta name="twitter:creator" content="@koichincom" />

        <link rel="canonical" href={siteUrl} />

        <link
            rel="alternate"
            type="application/rss+xml"
            title="Koichi's Writing"
            href="/rss.xml"
        />

        <ViewTransitions />

        <style is:global>
            ::view-transition-old(root),
            ::view-transition-new(root) {
                animation-duration: 0.2s;
            }

            @media (prefers-reduced-motion: reduce) {
                ::view-transition-old(root),
                ::view-transition-new(root) {
                    animation-duration: 0.01s;
                }
            }
        </style>
    </head>
    <body
        class="bg-(--color-background) dark:bg-(--color-background-dark) text-(--color-text-first) dark:text-(--color-text-first-dark) font-sans"
    >
        <Shortcuts id="shortcuts-modal" transition:persist />
        <div
            class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pt-6 sm:pt-6 lg:pt-5 pb-32"
        >
            <Header transition:persist />
            <div class="h-14 sm:h-16" aria-hidden="true"></div>
            {
                h1 && (
                    <h1 class="mt-0 text-2xl sm:text-3xl font-bold mb-8 text-(--color-text-first) dark:text-(--color-text-first-dark)">
                        {h1}
                    </h1>
                )
            }
            <slot />
            <div class="relative">
                <Footer transition:persist />
            </div>
        </div>

        <div
          id="global-tooltip"
          role="tooltip"
          aria-hidden="true"
          class="fixed z-[100] px-2 py-1 text-xs bg-(--color-text-first) dark:bg-(--color-text-first-dark) text-(--color-background) dark:text-(--color-background-dark) rounded opacity-0 transition-opacity duration-150 pointer-events-none whitespace-nowrap will-change-transform top-0 left-0 hidden sm:block"
        >
        </div>

        <script>
            import { initVimBindings } from "../scripts/vim";
            import { initGlobalTooltips } from "../scripts/tooltip";
            initVimBindings();
            initGlobalTooltips();

            document.addEventListener("astro:page-load", () => {
                initGlobalTooltips();
                if (window.location.pathname !== "/") {
                    // @ts-ignore
                    window.hasVisitedInternal = true;
                }
            });
        </script>
    </body>
</html>
