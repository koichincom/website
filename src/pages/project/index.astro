---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import ProjectList from "../../components/ProjectList.astro";

const title = "Projects";

const projectEntries = await getCollection("projects");
const sortProjects = (
    entries: typeof projectEntries,
): typeof projectEntries =>
    entries.sort((a, b) => {
        const pinnedDelta = Number(b.data.pinned ?? false) -
            Number(a.data.pinned ?? false);
        if (pinnedDelta !== 0) {
            return pinnedDelta;
        }
        return (
            new Date(b.data.published).getTime() -
            new Date(a.data.published).getTime()
        );
    });

const standardProjects = sortProjects(
    projectEntries.filter((project) => !project.data.hardwareBound),
);
const hardwareBoundProjects = sortProjects(
    projectEntries.filter((project) => project.data.hardwareBound),
);
---

<BaseLayout title={title}>
    <section class="mb-20">
        <ProjectList projects={standardProjects} />
    </section>
    {
        hardwareBoundProjects.length ? (
            <section class="mb-20">
                <!-- <h2 class="text-lg font-semibold text-(--color-text-first) dark:text-(--color-text-first-dark)"> -->
                <!--     Research -->
                <!-- </h2> -->
                <!-- <p class="mt-2 text-base text-(--color-text-third) dark:text-(--color-text-third-dark)"> -->
                <!--     Requires dedicated hardware, hosting, or notebook-based -->
                <!--     workflows. -->
                <!-- </p> -->
                <div class="mt-6">
                    <ProjectList projects={hardwareBoundProjects} />
                </div>
            </section>
        ) : null
    }
</BaseLayout>
