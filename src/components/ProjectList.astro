---
import ListRow from "./ListRow.astro";
import type { CollectionEntry } from "astro:content";
import { cssVarStyle, normalizeMinLines } from "../utils/min-lines";

export interface Props {
    projects: CollectionEntry<"projects">[];
    rowMinLines?: number;
}

const { projects, rowMinLines = 1 } = Astro.props;

const minLines = normalizeMinLines(rowMinLines);
const rowMinHeightClass = "sm:min-h-[calc(var(--project-row-min-lines)*1lh)]";
const nameColumnClass = [
    "min-w-0 sm:flex sm:items-center sm:leading-snug",
    rowMinHeightClass,
]
    .filter(Boolean)
    .join(" ");
const descriptionColumnClass = [
    "min-w-0 sm:flex sm:items-center mt-2 sm:mt-0 sm:leading-snug",
    rowMinHeightClass,
]
    .filter(Boolean)
    .join(" ");
---

<ul
    class="sm:grid sm:w-full sm:gap-x-36 sm:grid-cols-[fit-content(40%)_minmax(0,1fr)]"
>
    {
        projects.map((project) => (
            <ListRow
                href={project.data.url}
                target="_blank"
                rel="noopener noreferrer"
                ariaLabel={`Open ${project.data.name}`}
                rowClass="sm:col-span-full sm:grid sm:grid-cols-[subgrid]"
                class="no-custom-underline sm:grid sm:grid-cols-[subgrid] sm:col-span-full sm:items-start"
            >
                <div
                    class={nameColumnClass}
                    style={cssVarStyle("--project-row-min-lines", minLines)}
                >
                    <span class="text-base font-semibold text-(--color-text-second) dark:text-(--color-text-second-dark) group-hover:text-(--color-accent-light) dark:group-hover:text-(--color-accent-dark) min-w-0 break-words leading-snug">
                        {project.data.name}
                    </span>
                </div>
                <div
                    class={descriptionColumnClass}
                    style={cssVarStyle("--project-row-min-lines", minLines)}
                >
                    <span class="text-base text-(--color-text-third) dark:text-(--color-text-third-dark) min-w-0 break-words leading-snug">
                        {project.data.description}
                    </span>
                </div>
            </ListRow>
        ))
    }
</ul>
