---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import ProjectList from "../../components/ProjectList.astro";
import PageTitle from "../../components/PageTitle.astro";
import NewWindowLink from "../../components/NewWindowLink.astro";

const title = "Projects";
const metaTitle = title;

const Projects = await getCollection("projects");
const sortProjects = (entries: typeof Projects): typeof Projects =>
    entries.sort((a, b) => {
        const pinnedDelta =
            Number(b.data.pinned ?? false) - Number(a.data.pinned ?? false);
        if (pinnedDelta !== 0) {
            return pinnedDelta;
        }
        return (
            new Date(b.data.published).getTime() -
            new Date(a.data.published).getTime()
        );
    });

const sortedProjects = sortProjects(Projects);
---

<BaseLayout metaTitle={metaTitle}>
    <PageTitle>{title}</PageTitle>
    <p class="px-content-inset mb-8">
        Making things is my huge interest from my childhood. Now I make things
        to make the world better and advance humanity. You can get updates via <NewWindowLink
            href="/feed">Atom feeds</NewWindowLink
        >.
    </p>
    <ul class="px-content-inset mb-8">
        <li>
            <b>Try-out: </b> you can quickly try out from the link.
        </li>
        <li>
            <b>Hardware:</b> require hardware and may not use it right away.
        </li>
        <li>
            <b>Opensource:</b> the code is open-sourced. Check the repo for license.
        </li>
        <li>
            <b>Experimental:</b> built as an experimentation. Not for actual use.
        </li>
    </ul>
    {sortedProjects.length ? <ProjectList projects={sortedProjects} /> : null}
</BaseLayout>
